spring:
  application:
    name: petclinic-test
  docker:
    compose:
      enabled: false

external:
  payment:
    url: http://localhost:${wiremock.payment.port:8081}
  notification:
    url: http://localhost:${wiremock.notification.port:8082}

resilience4j:
  circuitbreaker:
    instances:
      paymentService:
        slidingWindowSize: 5
        failureRateThreshold: 50
        waitDurationInOpenState: 5s
        permittedNumberOfCallsInHalfOpenState: 2
      notificationService:
        slidingWindowSize: 5
        failureRateThreshold: 50
        waitDurationInOpenState: 3s
        permittedNumberOfCallsInHalfOpenState: 2
  retry:
    instances:
      notificationService:
        maxAttempts: 2
        waitDuration: 100ms
  ratelimiter:
    instances:
      createEndpoints:
        limitForPeriod: 100
        limitRefreshPeriod: 1s
        timeoutDuration: 0ms


management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: always
      show-components: always
      probes:
        enabled: true
  health:
    livenessstate:
      enabled: true
    readinessstate:
      enabled: true
  info:
    env:
      enabled: true
    git:
      mode: full
  observations:
    annotations:
      enabled: true
  metrics:
    tags:
      application: ${spring.application.name}
  otlp:
    metrics:
      export:
        enabled: false
  tracing:
    sampling:
      probability: 1.0
    export:
      enabled: false
      otlp:
        enabled: false
    propagation:
      type: W3C
  opentelemetry:
    resource-attributes:
      deployment.environment: ${spring.config.activate.on-profile}

logging:
  level:
    root: WARN
    com.kirndoubleb.labs: DEBUG
    org.testcontainers: INFO
